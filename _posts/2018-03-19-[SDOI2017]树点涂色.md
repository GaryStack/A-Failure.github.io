---
layout:     post
title:      "[SDOI2017]树点涂色"
date:       2018-03-19
author:     "DieSheep"
header-img: "img/14.jpg"
catalog: true
tags:
    - Link Cut Tree
---
# [题目](https://www.luogu.org/problemnew/show/P3703)

## 题目描述

Bob有一棵n个点的有根树，其中1号点是根节点。Bob在每个点上涂了颜色，并且每个点上的颜色不同。

定义一条路径的权值是：这条路径上的点（包括起点和终点）共有多少种不同的颜色。

Bob可能会进行这几种操作：

1 x
把点x到根节点的路径上所有的点染上一种没有用过的新颜色。

2 x y
求x到y的路径的权值。

3 x
在以x为根的子树中选择一个点，使得这个点到根节点的路径权值最大，求最大权值。

Bob一共会进行m次操作

## 输入输出格式

### 输入格式：

第一行两个数n,m。

接下来n-1行，每行两个数a,b，表示a与b之间有一条边。

接下来m行，表示操作，格式见题目描述

### 输出格式：

每当出现2,3操作，输出一行。

如果是2操作，输出一个数表示路径的权值

如果是3操作，输出一个数表示权值的最大值

## 输入输出样例

### 输入样例#1： 

<strong>5 6</strong>

<strong>1 2</strong>

<strong>2 3</strong>

<strong>3 4</strong>

<strong>3 5</strong>

<strong>2 4 5</strong>

<strong>3 3</strong>

<strong>1 4</strong>

<strong>2 4 5</strong>

<strong>1 5</strong>

<strong>2 4 5</strong>

### 输出样例#1： 

<strong>3</strong>

<strong>4</strong>

<strong>2</strong>

<strong>2</strong>

## 说明

共10个测试点

测试点1，1<=n,m<=1000

测试点2、3，没有2操作

测试点4、5，没有3操作

测试点6，树的生成方式是，对于i(2≤i≤n) ，在1到i−1中随机选一个点作为i的父节点。

测试点7，1≤n,m≤50000

测试点8，1≤n≤50000

测试点9,10，无特殊限制

对所有数据，1≤n≤10^5，1≤m≤10^5
 

时间限制：1s

空间限制：128MB
